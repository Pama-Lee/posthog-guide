"use strict";(self.webpackChunkposthog_guide=self.webpackChunkposthog_guide||[]).push([[9395],{43831:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>a,contentTitle:()=>t,default:()=>p,edges:()=>h,frontMatter:()=>d,metadata:()=>s,nodes:()=>o,toc:()=>x});const s=JSON.parse('{"id":"\ud83c\udfed \u57fa\u672c\u67b6\u6784/capture_architecture","title":"\u6570\u636e\u6444\u5165\u67b6\u6784","description":"\u6570\u636e\u6d41\u7a0b\u6982\u8ff0","source":"@site/docs/\ud83c\udfed \u57fa\u672c\u67b6\u6784/capture_architecture.mdx","sourceDirName":"\ud83c\udfed \u57fa\u672c\u67b6\u6784","slug":"/\ud83c\udfed \u57fa\u672c\u67b6\u6784/capture_architecture","permalink":"/posthog-guide/docs/\ud83c\udfed \u57fa\u672c\u67b6\u6784/capture_architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/pama-lee/posthog-guide/tree/main/docs/\ud83c\udfed \u57fa\u672c\u67b6\u6784/capture_architecture.mdx","tags":[],"version":"current","frontMatter":{"title":"\u6570\u636e\u6444\u5165\u67b6\u6784"},"sidebar":"tutorialSidebar","previous":{"title":"\ud83c\udfed \u57fa\u672c\u67b6\u6784","permalink":"/posthog-guide/docs/category/-\u57fa\u672c\u67b6\u6784"},"next":{"title":"PostHog Plugin Server \u67b6\u6784\u8bf4\u660e","permalink":"/posthog-guide/docs/\ud83c\udfed \u57fa\u672c\u67b6\u6784/plugin_server_architecture"}}');var l=i(74848),r=i(28453),c=i(75560);const d={title:"\u6570\u636e\u6444\u5165\u67b6\u6784"},t="PostHog \u6570\u636e\u6444\u5165\u67b6\u6784",a={},o=[{id:"client",data:{label:"\u5ba2\u6237\u7aef"},position:{x:0,y:0}},{id:"lb",data:{label:"\u8d1f\u8f7d\u5747\u8861\u5668"},position:{x:200,y:0}},{id:"api",data:{label:"API \u670d\u52a1\u5668"},position:{x:400,y:0}},{id:"kafka1",data:{label:"Kafka\nevents_plugin_ingestion"},position:{x:600,y:0}},{id:"ps",data:{label:"Plugin Server"},position:{x:800,y:0}},{id:"ch",data:{label:"ClickHouse"},position:{x:1e3,y:-100}},{id:"pg",data:{label:"PostgreSQL"},position:{x:1e3,y:0}},{id:"redis",data:{label:"Redis"},position:{x:1e3,y:100}}],h=[{id:"e1",source:"client",target:"lb",label:"HTTP/HTTPS"},{id:"e2",source:"lb",target:"api",label:"\u8bf7\u6c42\u5206\u53d1"},{id:"e3",source:"api",target:"kafka1",label:"\u751f\u4ea7\u6d88\u606f"},{id:"e4",source:"kafka1",target:"ps",label:"\u6d88\u8d39\u6d88\u606f"},{id:"e5",source:"ps",target:"ch",label:"\u5199\u5165\u4e8b\u4ef6"},{id:"e6",source:"ps",target:"pg",label:"\u5199\u5165\u7528\u6237\u6570\u636e"},{id:"e7",source:"ps",target:"redis",label:"\u7f13\u5b58"}],x=[{value:"\u6570\u636e\u6d41\u7a0b\u6982\u8ff0",id:"\u6570\u636e\u6d41\u7a0b\u6982\u8ff0",level:2},{value:"1. \u6807\u51c6\u5206\u6790\u4e8b\u4ef6\u6d41\u7a0b",id:"1-\u6807\u51c6\u5206\u6790\u4e8b\u4ef6\u6d41\u7a0b",level:3},{value:"2. \u7279\u6b8a\u4e8b\u4ef6\u6d41\u7a0b",id:"2-\u7279\u6b8a\u4e8b\u4ef6\u6d41\u7a0b",level:3},{value:"Kafka Topics \u8bf4\u660e",id:"kafka-topics-\u8bf4\u660e",level:2},{value:"1. \u6807\u51c6\u4e8b\u4ef6 Topics",id:"1-\u6807\u51c6\u4e8b\u4ef6-topics",level:3},{value:"2. \u7279\u6b8a\u4e8b\u4ef6 Topics",id:"2-\u7279\u6b8a\u4e8b\u4ef6-topics",level:3},{value:"\u8bf7\u6c42\u6d41\u7a0b\u8be6\u89e3",id:"\u8bf7\u6c42\u6d41\u7a0b\u8be6\u89e3",level:2},{value:"1. \u6807\u51c6\u5206\u6790\u4e8b\u4ef6",id:"1-\u6807\u51c6\u5206\u6790\u4e8b\u4ef6",level:3},{value:"2. \u7279\u6b8a\u4e8b\u4ef6\u5904\u7406",id:"2-\u7279\u6b8a\u4e8b\u4ef6\u5904\u7406",level:3},{value:"\u9ad8\u53ef\u7528\u8981\u6c42",id:"\u9ad8\u53ef\u7528\u8981\u6c42",level:2},{value:"\u5173\u952e\u914d\u7f6e\u53c2\u6570",id:"\u5173\u952e\u914d\u7f6e\u53c2\u6570",level:2},{value:"\u76d1\u63a7\u6307\u6807",id:"\u76d1\u63a7\u6307\u6807",level:2},{value:"\u6545\u969c\u6062\u590d",id:"\u6545\u969c\u6062\u590d",level:2}];function j(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"posthog-\u6570\u636e\u6444\u5165\u67b6\u6784",children:"PostHog \u6570\u636e\u6444\u5165\u67b6\u6784"})}),"\n",(0,l.jsx)(c.A,{nodes:o,edges:h,direction:"LR"}),"\n",(0,l.jsx)(e.h2,{id:"\u6570\u636e\u6d41\u7a0b\u6982\u8ff0",children:"\u6570\u636e\u6d41\u7a0b\u6982\u8ff0"}),"\n",(0,l.jsx)(e.p,{children:"PostHog \u7684\u4e8b\u4ef6\u5904\u7406\u7cfb\u7edf\u652f\u6301\u4e24\u79cd\u4e3b\u8981\u7684\u6570\u636e\u6d41\u7a0b\uff0c\u5206\u522b\u7528\u4e8e\u5904\u7406\u666e\u901a\u5206\u6790\u4e8b\u4ef6\u548c\u7279\u6b8a\u4e8b\u4ef6\u3002"}),"\n",(0,l.jsx)(e.h3,{id:"1-\u6807\u51c6\u5206\u6790\u4e8b\u4ef6\u6d41\u7a0b",children:"1. \u6807\u51c6\u5206\u6790\u4e8b\u4ef6\u6d41\u7a0b"}),"\n",(0,l.jsx)(e.mermaid,{value:'graph TD\n    Client[\u5ba2\u6237\u7aef] --\x3e|HTTP/HTTPS| LB[\u8d1f\u8f7d\u5747\u8861\u5668]\n    LB --\x3e|\u8bf7\u6c42\u5206\u53d1| API[API \u670d\u52a1\u5668]\n    API --\x3e|\u751f\u4ea7\u6d88\u606f| K1[Kafka events_plugin_ingestion]\n    K1 --\x3e|\u6d88\u8d39\u6d88\u606f| PS[Plugin Server]\n    PS --\x3e|\u5199\u5165\u4e8b\u4ef6| CH[(ClickHouse)]\n    PS --\x3e|\u5199\u5165\u7528\u6237\u6570\u636e| PG[(PostgreSQL)]\n    PS --\x3e|\u7f13\u5b58| Redis[(Redis)]\n    \n    subgraph "Plugin Server \u5904\u7406"\n        PS --\x3e|1. \u63a5\u6536| IC[IngestionConsumer]\n        IC --\x3e|2. \u5904\u7406| EPR[EventPipelineRunner]\n        EPR --\x3e|3. \u6267\u884c\u63d2\u4ef6| Plugins[Plugins]\n        EPR --\x3e|4. \u5b58\u50a8| Storage[\u5b58\u50a8\u5c42]\n    end'}),"\n",(0,l.jsx)(e.h3,{id:"2-\u7279\u6b8a\u4e8b\u4ef6\u6d41\u7a0b",children:"2. \u7279\u6b8a\u4e8b\u4ef6\u6d41\u7a0b"}),"\n",(0,l.jsx)(e.mermaid,{value:'graph TD\n    Client[\u5ba2\u6237\u7aef] --\x3e|HTTP/HTTPS| LB[\u8d1f\u8f7d\u5747\u8861\u5668]\n    LB --\x3e|\u8bf7\u6c42\u5206\u53d1| API[API \u670d\u52a1\u5668]\n    API --\x3e|\u751f\u4ea7\u6d88\u606f| K1[Kafka events_plugin_ingestion]\n    K1 --\x3e|\u6d88\u8d39\u6d88\u606f| PS[Plugin Server]\n    PS --\x3e|\u7279\u6b8a\u4e8b\u4ef6\u8f6c\u6362| K2[Kafka clickhouse_events]\n    K2 --\x3e|\u6d88\u8d39\u6d88\u606f| CH[(ClickHouse)]\n    PS --\x3e|\u5199\u5165\u7528\u6237\u6570\u636e| PG[(PostgreSQL)]\n    PS --\x3e|\u7f13\u5b58| Redis[(Redis)]\n\n    subgraph "\u7279\u6b8a\u4e8b\u4ef6\u7c7b\u578b"\n        SE1[\u4f1a\u8bdd\u5f55\u5236]\n        SE2[\u70ed\u56fe\u6570\u636e]\n        SE3[\u6027\u80fd\u6570\u636e]\n    end'}),"\n",(0,l.jsx)(e.h2,{id:"kafka-topics-\u8bf4\u660e",children:"Kafka Topics \u8bf4\u660e"}),"\n",(0,l.jsx)(e.h3,{id:"1-\u6807\u51c6\u4e8b\u4ef6-topics",children:"1. \u6807\u51c6\u4e8b\u4ef6 Topics"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"events_plugin_ingestion"}),": \u4e3b\u8981\u7684\u4e8b\u4ef6\u6444\u5165 topic"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"events_plugin_ingestion_historical"}),": \u5386\u53f2\u6570\u636e\u6444\u5165"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"events_plugin_ingestion_overflow"}),": \u6ea2\u51fa\u5904\u7406"]}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"2-\u7279\u6b8a\u4e8b\u4ef6-topics",children:"2. \u7279\u6b8a\u4e8b\u4ef6 Topics"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"clickhouse_session_recording_events"}),": \u4f1a\u8bdd\u5f55\u5236\u6570\u636e"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"clickhouse_session_replay_events"}),": \u4f1a\u8bdd\u56de\u653e\u6570\u636e"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"clickhouse_heatmap_events"}),": \u70ed\u56fe\u6570\u636e"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"clickhouse_performance_events"}),": \u6027\u80fd\u76d1\u63a7\u6570\u636e"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u8bf7\u6c42\u6d41\u7a0b\u8be6\u89e3",children:"\u8bf7\u6c42\u6d41\u7a0b\u8be6\u89e3"}),"\n",(0,l.jsx)(e.h3,{id:"1-\u6807\u51c6\u5206\u6790\u4e8b\u4ef6",children:"1. \u6807\u51c6\u5206\u6790\u4e8b\u4ef6"}),"\n",(0,l.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant C as Client\n    participant LB as Load Balancer\n    participant API as API Server\n    participant K as Kafka(events)\n    participant PS as Plugin Server\n    participant CH as ClickHouse\n    participant PG as PostgreSQL\n    participant R as Redis\n\n    C->>+LB: POST /capture\n    LB->>+API: \u8f6c\u53d1\u8bf7\u6c42\n    API->>API: \u9a8c\u8bc1\u8bf7\u6c42\n    API->>+K: \u751f\u4ea7\u4e8b\u4ef6\u6d88\u606f\n    K--\x3e>-API: \u786e\u8ba4\u63a5\u6536\n    API--\x3e>-LB: 200 OK\n    LB--\x3e>-C: 200 OK\n    \n    K->>+PS: \u6d88\u8d39\u4e8b\u4ef6\u6d88\u606f\n    PS->>PS: \u8fd0\u884c\u63d2\u4ef6\u5904\u7406\n    PS->>+CH: \u5199\u5165\u4e8b\u4ef6\u6570\u636e\n    CH--\x3e>-PS: \u786e\u8ba4\u5199\u5165\n    PS->>+PG: \u5199\u5165\u7528\u6237\u6570\u636e\n    PG--\x3e>-PS: \u786e\u8ba4\u5199\u5165\n    PS->>+R: \u66f4\u65b0\u7f13\u5b58\n    R--\x3e>-PS: \u786e\u8ba4\u66f4\u65b0\n    PS--\x3e>-K: \u63d0\u4ea4\u504f\u79fb\u91cf"}),"\n",(0,l.jsx)(e.h3,{id:"2-\u7279\u6b8a\u4e8b\u4ef6\u5904\u7406",children:"2. \u7279\u6b8a\u4e8b\u4ef6\u5904\u7406"}),"\n",(0,l.jsx)(e.mermaid,{value:"sequenceDiagram\n    participant C as Client\n    participant API as API Server\n    participant K1 as Kafka(events)\n    participant PS as Plugin Server\n    participant K2 as Kafka(clickhouse)\n    participant CH as ClickHouse\n\n    C->>+API: POST /capture\n    API->>+K1: \u751f\u4ea7\u4e8b\u4ef6\u6d88\u606f\n    K1--\x3e>-API: \u786e\u8ba4\u63a5\u6536\n    API--\x3e>-C: 200 OK\n    \n    K1->>+PS: \u6d88\u8d39\u4e8b\u4ef6\u6d88\u606f\n    PS->>PS: \u4e8b\u4ef6\u7c7b\u578b\u5224\u65ad\n    PS->>PS: \u7279\u6b8a\u5904\u7406\u8f6c\u6362\n    PS->>+K2: \u751f\u4ea7\u8f6c\u6362\u540e\u6d88\u606f\n    K2--\x3e>-PS: \u786e\u8ba4\u63a5\u6536\n    PS--\x3e>-K1: \u63d0\u4ea4\u504f\u79fb\u91cf\n    \n    K2->>+CH: \u5199\u5165\u8f6c\u6362\u540e\u6570\u636e\n    CH--\x3e>-K2: \u786e\u8ba4\u5199\u5165"}),"\n",(0,l.jsx)(e.h2,{id:"\u9ad8\u53ef\u7528\u8981\u6c42",children:"\u9ad8\u53ef\u7528\u8981\u6c42"}),"\n",(0,l.jsx)(e.p,{children:"\u4e3a\u4e86\u4fdd\u8bc1\u6d88\u606f\u6444\u5165\u7684\u9ad8\u53ef\u7528\u6027\uff0c\u9700\u8981\u786e\u4fdd\u4ee5\u4e0b\u7ec4\u4ef6\u7684\u5197\u4f59\u548c\u9ad8\u53ef\u7528\u914d\u7f6e\uff1a"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u8d1f\u8f7d\u5747\u8861\u5668"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u5efa\u8bae\u4f7f\u7528\u4e91\u670d\u52a1\u5546\u63d0\u4f9b\u7684\u8d1f\u8f7d\u5747\u8861\u670d\u52a1(\u5982AWS ELB)"}),"\n",(0,l.jsx)(e.li,{children:"\u6216\u4f7f\u7528 Nginx/HAProxy \u96c6\u7fa4"}),"\n",(0,l.jsx)(e.li,{children:"\u914d\u7f6e\u591a\u533a\u57df\u90e8\u7f72"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"Kafka \u96c6\u7fa4"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u6700\u5c113\u4e2a\u8282\u70b9\u7684\u96c6\u7fa4"}),"\n",(0,l.jsx)(e.li,{children:"\u914d\u7f6e\u9002\u5f53\u7684\u526f\u672c\u56e0\u5b50(\u5efa\u8bae \u2265 2)"}),"\n",(0,l.jsx)(e.li,{children:"\u542f\u7528\u591a\u5206\u533a(\u6839\u636e\u6d41\u91cf\u914d\u7f6e)"}),"\n",(0,l.jsxs)(e.li,{children:["\u914d\u7f6e ",(0,l.jsx)(e.code,{children:"min.insync.replicas \u2265 2"})]}),"\n",(0,l.jsx)(e.li,{children:"\u5bf9\u4e24\u7c7b topics \u90fd\u8981\u4fdd\u8bc1\u9ad8\u53ef\u7528"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"Plugin Server"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u90e8\u7f72\u591a\u4e2a\u5b9e\u4f8b"}),"\n",(0,l.jsx)(e.li,{children:"\u4f7f\u7528\u4e0d\u540c\u7684 consumer group"}),"\n",(0,l.jsx)(e.li,{children:"\u914d\u7f6e\u5408\u9002\u7684 partition \u5206\u914d\u7b56\u7565"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"ClickHouse"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u914d\u7f6e\u526f\u672c"}),"\n",(0,l.jsx)(e.li,{children:"\u4f7f\u7528\u5206\u5e03\u5f0f\u8868\u5f15\u64ce"}),"\n",(0,l.jsx)(e.li,{children:"\u914d\u7f6e ZooKeeper \u96c6\u7fa4"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"PostgreSQL"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u4e3b\u4ece\u590d\u5236\u914d\u7f6e"}),"\n",(0,l.jsx)(e.li,{children:"\u914d\u7f6e WAL \u5f52\u6863"}),"\n",(0,l.jsx)(e.li,{children:"\u8003\u8651\u4f7f\u7528\u8bfb\u5199\u5206\u79bb"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"Redis"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u914d\u7f6e\u4e3b\u4ece\u590d\u5236"}),"\n",(0,l.jsx)(e.li,{children:"\u8003\u8651\u4f7f\u7528 Redis Sentinel"}),"\n",(0,l.jsx)(e.li,{children:"\u6216\u4f7f\u7528 Redis Cluster"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u5173\u952e\u914d\u7f6e\u53c2\u6570",children:"\u5173\u952e\u914d\u7f6e\u53c2\u6570"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.strong,{children:"Kafka \u914d\u7f6e"})}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-yaml",children:"# \u901a\u7528\u914d\u7f6e\nreplication.factor: 3\nmin.insync.replicas: 2\n\n# events topic\nevents_plugin_ingestion:\n  num.partitions: 32\n  retention.ms: 604800000  # 7 days\n\n# clickhouse topics\nclickhouse_events:\n  num.partitions: 16\n  retention.ms: 259200000  # 3 days\n"})}),"\n",(0,l.jsxs)(e.ol,{start:"2",children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.strong,{children:"Plugin Server \u914d\u7f6e"})}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-yaml",children:"KAFKA_BATCH_SIZE: 100000\nKAFKA_FLUSH_FREQUENCY_MS: 500\nWORKER_CONCURRENCY: 4\n"})}),"\n",(0,l.jsxs)(e.ol,{start:"3",children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.strong,{children:"ClickHouse \u914d\u7f6e"})}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-yaml",children:"max_memory_usage: 20000000000\nmax_memory_usage_for_all_queries: 40000000000\nmax_partitions_per_insert_block: 100\n"})}),"\n",(0,l.jsx)(e.h2,{id:"\u76d1\u63a7\u6307\u6807",children:"\u76d1\u63a7\u6307\u6807"}),"\n",(0,l.jsx)(e.p,{children:"\u4e3a\u786e\u4fdd\u7cfb\u7edf\u7a33\u5b9a\u6027\uff0c\u9700\u8981\u76d1\u63a7\u4ee5\u4e0b\u5173\u952e\u6307\u6807\uff1a"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"Kafka \u6307\u6807"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u6d88\u606f\u5806\u79ef\u91cf(\u4e24\u7c7b topics \u5206\u522b\u76d1\u63a7)"}),"\n",(0,l.jsx)(e.li,{children:"\u751f\u4ea7\u8005/\u6d88\u8d39\u8005\u5ef6\u8fdf"}),"\n",(0,l.jsx)(e.li,{children:"\u5206\u533a\u5065\u5eb7\u72b6\u6001"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"Plugin Server \u6307\u6807"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u4e8b\u4ef6\u5904\u7406\u5ef6\u8fdf"}),"\n",(0,l.jsx)(e.li,{children:"\u9519\u8bef\u7387"}),"\n",(0,l.jsx)(e.li,{children:"\u5185\u5b58\u4f7f\u7528\u7387"}),"\n",(0,l.jsx)(e.li,{children:"\u7279\u6b8a\u4e8b\u4ef6\u8f6c\u6362\u5ef6\u8fdf"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u5b58\u50a8\u6307\u6807"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"ClickHouse \u5199\u5165\u5ef6\u8fdf"}),"\n",(0,l.jsx)(e.li,{children:"PostgreSQL \u8fde\u63a5\u72b6\u6001"}),"\n",(0,l.jsx)(e.li,{children:"Redis \u5185\u5b58\u4f7f\u7528\u7387"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u6545\u969c\u6062\u590d",children:"\u6545\u969c\u6062\u590d"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u6d88\u606f\u4e22\u5931\u9884\u9632"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["Kafka \u914d\u7f6e ",(0,l.jsx)(e.code,{children:"acks=all"})]}),"\n",(0,l.jsx)(e.li,{children:"\u542f\u7528\u751f\u4ea7\u8005\u91cd\u8bd5\u673a\u5236"}),"\n",(0,l.jsx)(e.li,{children:"\u914d\u7f6e\u5408\u9002\u7684\u6d88\u8d39\u8005\u63d0\u4ea4\u7b56\u7565"}),"\n",(0,l.jsx)(e.li,{children:"\u7279\u6b8a\u4e8b\u4ef6\u4e8c\u6b21\u786e\u8ba4\u673a\u5236"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u6570\u636e\u4e00\u81f4\u6027"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u4f7f\u7528\u4e8b\u52a1\u6216\u4e24\u9636\u6bb5\u63d0\u4ea4"}),"\n",(0,l.jsx)(e.li,{children:"\u914d\u7f6e\u9002\u5f53\u7684\u8d85\u65f6\u548c\u91cd\u8bd5\u7b56\u7565"}),"\n",(0,l.jsx)(e.li,{children:"\u5b9e\u73b0\u5e42\u7b49\u6027\u5904\u7406"}),"\n",(0,l.jsx)(e.li,{children:"\u7279\u6b8a\u4e8b\u4ef6\u7684\u91cd\u653e\u673a\u5236"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u5bb9\u91cf\u89c4\u5212"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u9884\u7559\u8db3\u591f\u7684\u5b58\u50a8\u7a7a\u95f4"}),"\n",(0,l.jsx)(e.li,{children:"\u76d1\u63a7\u7cfb\u7edf\u8d44\u6e90\u4f7f\u7528"}),"\n",(0,l.jsx)(e.li,{children:"\u5236\u5b9a\u6269\u5bb9\u9608\u503c\u548c\u7b56\u7565"}),"\n",(0,l.jsx)(e.li,{children:"\u8003\u8651\u7279\u6b8a\u4e8b\u4ef6\u7684\u989d\u5916\u5b58\u50a8\u9700\u6c42"}),"\n"]}),"\n"]}),"\n"]})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(j,{...n})}):j(n)}},75560:(n,e,i)=>{i.d(e,{A:()=>u});var s=i(96540),l=i(67242),r=i(60403),c=i(75438),d=i(67828);i(49647);const t={flowContainer:"flowContainer_jSNB",customNode:"customNode_ckN1",nodeContent:"nodeContent_BbsH",nodeIcon:"nodeIcon_cTJt",nodeText:"nodeText_xgGQ",nodeLabel:"nodeLabel_MrSF",nodeDescription:"nodeDescription_hKKD"};var a=i(53115),o=i(76246),h=i.n(o),x=i(74848);const j={custom:(0,s.memo)((n=>{let{data:e}=n;return(0,x.jsxs)("div",{className:t.customNode,children:[(0,x.jsx)(l.h7,{type:"target",position:l.yX.Top}),(0,x.jsxs)("div",{className:t.nodeContent,children:[e.icon&&(0,x.jsx)("div",{className:t.nodeIcon,children:e.icon}),(0,x.jsxs)("div",{className:t.nodeText,children:[(0,x.jsx)("div",{className:t.nodeLabel,children:e.label}),e.description&&(0,x.jsx)("div",{className:t.nodeDescription,children:e.description})]})]}),(0,x.jsx)(l.h7,{type:"source",position:l.yX.Bottom})]})}))},p=function(n,e,i){void 0===i&&(i="TB");const s=new(h().graphlib.Graph);s.setDefaultEdgeLabel((()=>({})));s.setGraph({rankdir:i}),n.forEach((n=>{s.setNode(n.id,{width:250,height:80})})),e.forEach((n=>{s.setEdge(n.source,n.target)})),h().layout(s);return{nodes:n.map((n=>{const e=s.node(n.id);return{...n,position:{x:e.x-125,y:e.y-40}}})),edges:e}};function u(n){let{nodes:e,edges:i,direction:o="TB",minimap:h=!0,controls:u=!0,className:g,style:P,fitView:m=!0,nodeTypes:v,animated:S=!0}=n;const{colorMode:_}=(0,a.p)(),{nodes:k,edges:C}=(0,s.useMemo)((()=>p(e,i,o)),[e,i,o]),[K,f,b]=(0,l.ck)(k),[T,A,y]=(0,l.fM)(C.map((n=>({...n,animated:S,markerEnd:{type:l.TG.ArrowClosed}})))),H=(0,s.useCallback)((n=>A((e=>(0,l.rN)(n,e)))),[A]),I=(0,s.useMemo)((()=>({...j,...v})),[v]),N="dark"===_;return(0,x.jsx)("div",{className:`${t.flowContainer} ${g||""}`,style:P,children:(0,x.jsxs)(l.Gc,{nodes:K,edges:T,onNodesChange:b,onEdgesChange:y,onConnect:H,nodeTypes:I,fitView:m,proOptions:{hideAttribution:!0},children:[h&&(0,x.jsx)(r.o,{}),u&&(0,x.jsx)(c.H,{}),(0,x.jsx)(d.V,{color:N?"#444":"#ddd"})]})})}}}]);