---
title: ä¼ä¸šå¾®ä¿¡æœºå™¨äººæ’ä»¶æŒ‡å—
subtitle: å°† PostHog å‘Šè­¦æ¶ˆæ¯å®æ—¶æ¨é€åˆ°ä¼ä¸šå¾®ä¿¡ç¾¤
---

import GitHubCard from '@site/src/components/GithubCard';

## ä¸ºä»€ä¹ˆä½¿ç”¨ä¼ä¸šå¾®ä¿¡æœºå™¨äººæ’ä»¶ï¼Ÿ

![ä¼ä¸šå¾®ä¿¡](/img/posthog-wecom-logo.png)

<GitHubCard repo="pama-lee/posthog-wecom-plugin" size='medium'/>

ä¼ä¸šå¾®ä¿¡æœºå™¨äººæ’ä»¶å¯ä»¥å¸®åŠ©ä½ ï¼š

1. å®æ—¶æ¥æ”¶ PostHog å¹³å°çš„å‘Šè­¦é€šçŸ¥
2. åœ¨ä¼ä¸šå¾®ä¿¡ç¾¤ä¸­å¿«é€Ÿå“åº”å’Œå¤„ç†å‘Šè­¦
3. æé«˜å›¢é˜Ÿåä½œæ•ˆç‡å’Œå‘Šè­¦å¤„ç†é€Ÿåº¦

## å·¥ä½œåŸç†

```mermaid
flowchart LR
    A[PostHog å¹³å°] -->|å‘Šè­¦è§¦å‘| B[æ’ä»¶æœåŠ¡å™¨]
    B -->|äº‹ä»¶å¤„ç†| C[ä¼ä¸šå¾®ä¿¡æ’ä»¶]
    C -->|æ¶ˆæ¯æ¨é€| D[ä¼ä¸šå¾®ä¿¡æœºå™¨äºº]
    D -->|ç¾¤æ¶ˆæ¯| E[ä¼ä¸šå¾®ä¿¡ç¾¤]
```

### ç³»ç»Ÿç»„ä»¶

```mermaid
graph TB
    subgraph PostHog[PostHog å¹³å°]
        A1[å‘Šè­¦ç³»ç»Ÿ] --> A2[äº‹ä»¶è§¦å‘å™¨]
    end
    
    subgraph Plugin[æ’ä»¶ç³»ç»Ÿ]
        B1[äº‹ä»¶å¤„ç†å™¨] --> B2[æ¶ˆæ¯æ ¼å¼åŒ–]
        B2 --> B3[HTTP å®¢æˆ·ç«¯]
    end
    
    subgraph WeCom[ä¼ä¸šå¾®ä¿¡]
        C1[Webhook API] --> C2[æ¶ˆæ¯åˆ†å‘]
        C2 --> C3[ç¾¤æ¶ˆæ¯å±•ç¤º]
    end
    
    PostHog --> Plugin
    Plugin --> WeCom
```

## åŠŸèƒ½ç‰¹æ€§

### 1. æ¶ˆæ¯é€šçŸ¥
- Markdown æ ¼å¼æ”¯æŒ
- è‡ªå®šä¹‰æ¶ˆæ¯æ¨¡æ¿
- åŠ¨æ€å˜é‡æ›¿æ¢
- å®æ—¶æ¨é€

### 2. é…ç½®é€‰é¡¹
- Webhook URL é…ç½®
- æ¶ˆæ¯æ¨¡æ¿å®šåˆ¶
- å‘Šè­¦è§„åˆ™è®¾ç½®
- ç¾¤ç»„ç®¡ç†

### 3. å®‰å…¨æ€§
- HTTPS åŠ å¯†ä¼ è¾“
- Webhook å¯†é’¥ä¿æŠ¤
- è®¿é—®æƒé™æ§åˆ¶
- é…ç½®åŠ å¯†å­˜å‚¨

## å¿«é€Ÿå¼€å§‹

1. **å®‰è£…æ’ä»¶**
   ```bash
   # åœ¨ PostHog æ’ä»¶å¸‚åœºä¸­æœç´¢å¹¶å®‰è£…
   ä¼ä¸šå¾®ä¿¡æœºå™¨äººé€šçŸ¥æ’ä»¶
   ```

2. **é…ç½® Webhook**
   ```json
   {
     "webhookUrl": "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=YOUR_KEY",
     "messageTemplate": "## PostHog å‘Šè­¦\n**${alert_name}**\n${description}"
   }
   ```

3. **æµ‹è¯•è¿æ¥**
   ```mermaid
   sequenceDiagram
       participant P as PostHog
       participant W as ä¼ä¸šå¾®ä¿¡
       P->>W: å‘é€æµ‹è¯•æ¶ˆæ¯
       W-->>P: è¿”å›æˆåŠŸå“åº”
       Note over P,W: éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®
   ```

## æœ€ä½³å®è·µ

### å‘Šè­¦é…ç½®

1. **åˆç†è®¾ç½®å‘Šè­¦é˜ˆå€¼**
   ```json
   {
     "metric": "events_count",
     "threshold": 1000,
     "timeWindow": "5m"
   }
   ```

2. **åˆ†çº§å‘Šè­¦æ¨¡æ¿**
   ```markdown
   ## [${level}] ç³»ç»Ÿå‘Šè­¦
   - å‘Šè­¦åç§°: ${alert_name}
   - è§¦å‘æ—¶é—´: ${trigger_time}
   - è¯¦ç»†ä¿¡æ¯: ${description}
   ```

### æ¶ˆæ¯æ¨¡æ¿

1. **åŸºç¡€æ¨¡æ¿**
   ```markdown
   ## PostHog å‘Šè­¦é€šçŸ¥
   **å‘Šè­¦åç§°**: ${alert_name}
   **è§¦å‘æ—¶é—´**: ${trigger_time}
   **è¯¦ç»†ä¿¡æ¯**: ${description}
   ```

2. **é«˜çº§æ¨¡æ¿**
   ```markdown
   ## ğŸš¨ PostHog å‘Šè­¦é€šçŸ¥
   ### ğŸ“Š å‘Šè­¦è¯¦æƒ…
   - **åç§°**: ${alert_name}
   - **çº§åˆ«**: ${level}
   - **æ—¶é—´**: ${trigger_time}
   
   ### ğŸ“ è¯¦ç»†ä¿¡æ¯
   ${description}
   
   ### ğŸ”— ç›¸å…³é“¾æ¥
   [æŸ¥çœ‹ä»ªè¡¨ç›˜](${dashboard_url})
   ```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ¶ˆæ¯å‘é€å¤±è´¥**
   ```mermaid
   graph TD
       A[å‘é€å¤±è´¥] --> B{æ£€æŸ¥ç½‘ç»œ}
       B -->|æ­£å¸¸| C{éªŒè¯ URL}
       B -->|å¼‚å¸¸| D[ä¿®å¤ç½‘ç»œ]
       C -->|æ­£ç¡®| E{æŸ¥çœ‹æ—¥å¿—}
       C -->|é”™è¯¯| F[æ›´æ–° URL]
   ```

2. **é…ç½®é—®é¢˜**
   - æ£€æŸ¥ Webhook URL æ ¼å¼
   - éªŒè¯æ¶ˆæ¯æ¨¡æ¿è¯­æ³•
   - ç¡®è®¤æƒé™è®¾ç½®

## API å‚è€ƒ

### äº‹ä»¶ç»“æ„
```typescript
interface PluginEvent {
    event: string              // äº‹ä»¶ç±»å‹
    properties: {
        alert_name: string     // å‘Šè­¦åç§°
        description: string    // å‘Šè­¦æè¿°
        insight_name?: string  // æ´å¯Ÿåç§°
        dashboard_name?: string // ä»ªè¡¨ç›˜åç§°
    }
}
```

### é…ç½®é€‰é¡¹
```typescript
interface PluginConfig {
    webhookUrl: string        // Webhook URL
    messageTemplate: string   // æ¶ˆæ¯æ¨¡æ¿
}
```

## æ€§èƒ½ä¼˜åŒ–

### ç›‘æ§æŒ‡æ ‡
1. æ¶ˆæ¯å»¶è¿Ÿ
2. å‘é€æˆåŠŸç‡
3. é”™è¯¯ç‡ç»Ÿè®¡

### ä¼˜åŒ–å»ºè®®
1. åˆç†è®¾ç½®é‡è¯•ç­–ç•¥
2. ä¼˜åŒ–æ¶ˆæ¯å¤§å°
3. è°ƒæ•´å¹¶å‘é™åˆ¶

## æ›´æ–°æ—¥å¿—

### v1.0.0
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŸºç¡€å‘Šè­¦åŠŸèƒ½
- Markdown æ”¯æŒ

## ç›¸å…³èµ„æº

- [PostHog æ–‡æ¡£](https://posthog.com/docs)
- [ä¼ä¸šå¾®ä¿¡ API æ–‡æ¡£](https://work.weixin.qq.com/api/doc)
- [æ’ä»¶ GitHub ä»“åº“](https://github.com/pama-lee/posthog-wecom-plugin)

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Pull Request å’Œ Issueï¼

