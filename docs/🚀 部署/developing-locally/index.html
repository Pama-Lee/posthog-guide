<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-🚀 部署/developing-locally" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">本地开发 | PostHog 指南</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://pama-lee.github.io/posthog-guide/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://pama-lee.github.io/posthog-guide/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://pama-lee.github.io/posthog-guide/docs/🚀 部署/developing-locally"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="本地开发 | PostHog 指南"><meta data-rh="true" name="description" content="❗️ 本指南仅适用于 PostHog 本身的开发。如果你想部署 PostHog 用于产品分析需求，请前往自托管 PostHog。"><meta data-rh="true" property="og:description" content="❗️ 本指南仅适用于 PostHog 本身的开发。如果你想部署 PostHog 用于产品分析需求，请前往自托管 PostHog。"><link data-rh="true" rel="icon" href="/posthog-guide/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://pama-lee.github.io/posthog-guide/docs/🚀 部署/developing-locally"><link data-rh="true" rel="alternate" href="https://pama-lee.github.io/posthog-guide/docs/🚀 部署/developing-locally" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://pama-lee.github.io/posthog-guide/docs/🚀 部署/developing-locally" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/posthog-guide/blog/rss.xml" title="PostHog 指南 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/posthog-guide/blog/atom.xml" title="PostHog 指南 Atom Feed"><link rel="stylesheet" href="/posthog-guide/assets/css/styles.93c2b873.css">
<script src="/posthog-guide/assets/js/runtime~main.46c73bd9.js" defer="defer"></script>
<script src="/posthog-guide/assets/js/main.8e68062b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/posthog-guide/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/posthog-guide/"><div class="navbar__logo"><img src="/posthog-guide/img/logo.svg" alt="PostHog 刺猬" class="themedComponent_mlkZ themedComponent--light_NVdE" height="32" width="32"><img src="/posthog-guide/img/logo.svg" alt="PostHog 刺猬" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="32" width="32"></div><b class="navbar__title text--truncate">PostHog 指南</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/posthog-guide/docs/intro">文档</a><a class="navbar__item navbar__link" href="/posthog-guide/blog">博客</a><a class="navbar__item navbar__link" href="/posthog-guide/plugin-market">插件市场</a><a class="navbar__item navbar__link" href="/posthog-guide/plugin-generator">插件生成器</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/pama-lee/posthog-guide" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/posthog-guide/docs/intro">PostHog 指南</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/posthog-guide/docs/category/-基本架构">🏭 基本架构</a><button aria-label="展开侧边栏分类 &#x27;🏭 基本架构&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/posthog-guide/docs/category/-部署">🚀 部署</a><button aria-label="折叠侧边栏分类 &#x27;🚀 部署&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/posthog-guide/docs/🚀 部署/cloud-cluster">Cloud 集群架构</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/posthog-guide/docs/🚀 部署/developing-locally">本地开发</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/posthog-guide/docs/🚀 部署/nomad">使用 Nomad 部署 PostHog</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/posthog-guide/docs/category/-捕获服务">📡 捕获服务</a><button aria-label="展开侧边栏分类 &#x27;📡 捕获服务&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/posthog-guide/docs/category/️-负载均衡与转发">⚖️ 负载均衡与转发</a><button aria-label="展开侧边栏分类 &#x27;⚖️ 负载均衡与转发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/posthog-guide/docs/category/-持久化数据库">💾 持久化数据库</a><button aria-label="展开侧边栏分类 &#x27;💾 持久化数据库&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/posthog-guide/docs/🔍 HogQL/aggregations">🔍 HogQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/posthog-guide/docs/🧩 插件与资源/data-flow-chart">🧩 插件与资源</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/posthog-guide/plugin-market">插件市场</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/posthog-guide/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/posthog-guide/docs/category/-部署"><span itemprop="name">🚀 部署</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">本地开发</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>本地开发</h1></header><blockquote>
<p>❗️ 本指南仅适用于 PostHog 本身的开发。如果你想部署 PostHog 用于产品分析需求，请前往<a href="/posthog-guide/docs/self-host">自托管 PostHog</a>。</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="posthog-内部结构是什么样的">PostHog 内部结构是什么样的？<a href="#posthog-内部结构是什么样的" class="hash-link" aria-label="PostHog 内部结构是什么样的？的直接链接" title="PostHog 内部结构是什么样的？的直接链接">​</a></h2>
<p>在开始设置之前，让我们先了解 PostHog 的组成部分。</p>
<p>该应用由 4 个同时运行的组件组成：</p>
<ul>
<li>Celery worker（处理后台任务）</li>
<li>Django 服务器</li>
<li>Node.js 插件服务器（处理事件接收和应用/插件）</li>
<li>使用 Node.js 构建的 React 前端</li>
</ul>
<p>这些组件依赖于以下外部服务：</p>
<ul>
<li>ClickHouse – 用于存储大数据（事件、用户、分析查询）</li>
<li>Kafka – 用于事件接收队列</li>
<li>MinIO – 用于存储文件（会话录制、文件导出）</li>
<li>PostgreSQL – 用于存储普通数据（用户、项目、保存的洞察）</li>
<li>Redis – 用于缓存和服务间通信</li>
<li>Zookeeper – 用于协调 Kafka 和 ClickHouse 集群</li>
</ul>
<p>在启动 PostHog 开发实例时，我们推荐以下配置：</p>
<ul>
<li>外部服务通过 <code>docker compose</code> 在 Docker 中运行</li>
<li>PostHog 本身在主机（你的系统）上运行</li>
</ul>
<p>这就是我们在下面的指南中将要使用的配置。</p>
<blockquote>
<p>技术上也可以完全在 Docker 中运行 PostHog，但同步更改会变得更慢，而且为了开发，你仍然需要在主机上安装 PostHog 依赖项（如格式化或类型检查工具）。
另一种方式 - 完全在主机上运行所有内容，由于从头开始实例化 Kafka 或 ClickHouse 涉及的复杂性较大，这在实践中是不可行的。</p>
</blockquote>
<p>本指南假设你运行的是 macOS 或当前的 Ubuntu Linux LTS（24.04）。</p>
<p>对于其他 Linux 发行版，请根据需要调整步骤（例如，使用 <code>dnf</code> 或 <code>pacman</code> 代替 <code>apt</code>）。</p>
<p>Windows 本身不支持。但是，Windows 用户可以运行 Linux 虚拟机。推荐使用最新的 Ubuntu LTS Desktop。（不推荐使用 Ubuntu Server，因为调试前端需要能够访问 localhost 的浏览器。）</p>
<p>如果这里的一些步骤已经过时，请告诉我们 - 欢迎<a href="https://github.com/PostHog/posthog.com/blob/master/contents/handbook/engineering/developing-locally.md" target="_blank" rel="noopener noreferrer">提交补丁</a>！</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="选项一使用-codespaces-开发">选项一：使用 Codespaces 开发<a href="#选项一使用-codespaces-开发" class="hash-link" aria-label="选项一：使用 Codespaces 开发的直接链接" title="选项一：使用 Codespaces 开发的直接链接">​</a></h2>
<p>这是一个更快速的入门选项。如果你不想或无法使用 Codespaces，请继续阅读下一节。</p>
<ol>
<li>创建你的 codespace。
<img decoding="async" loading="lazy" src="https://user-images.githubusercontent.com/890921/231489405-cb2010b4-d9e3-4837-bfdf-b2d4ef5c5d0b.png" alt="" class="img_ev3q"></li>
<li>更新为 8 核机器类型（最小配置可能太小，无法正常运行 PostHog）。
<img decoding="async" loading="lazy" src="https://user-images.githubusercontent.com/890921/231490278-140f814e-e77b-46d5-9a4f-31c1b1d6956a.png" alt="" class="img_ev3q"></li>
<li>打开 codespace，使用列表中的&quot;Open in&quot;选项之一。</li>
<li>在 codespace 中，打开终端窗口并运行 <code>docker compose -f docker-compose.dev.yml up</code>。</li>
<li>在另一个终端中，运行 <code>pnpm i</code>（并在后续命令中使用相同的终端）</li>
<li>然后运行 <code>pip install -r requirements.txt -r requirements-dev.txt</code></li>
<li>现在运行 <code>./bin/migrate</code> 然后运行 <code>./bin/start</code>。</li>
<li>在浏览器中打开 <a href="http://localhost:8010/%E3%80%82" target="_blank" rel="noopener noreferrer">http://localhost:8010/。</a></li>
<li>要在你全新的 PostHog 实例中获取一些实用的测试数据，运行 <code>DEBUG=1 ./manage.py generate_demo_data</code>。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="选项二本地开发">选项二：本地开发<a href="#选项二本地开发" class="hash-link" aria-label="选项二：本地开发的直接链接" title="选项二：本地开发的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="先决条件">先决条件<a href="#先决条件" class="hash-link" aria-label="先决条件的直接链接" title="先决条件的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="macos">macOS<a href="#macos" class="hash-link" aria-label="macOS的直接链接" title="macOS的直接链接">​</a></h4>
<ol>
<li>
<p>如果你还没有安装 Xcode Command Line Tools，请安装：<code>xcode-select --install</code>。</p>
</li>
<li>
<p>按照<a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">这里的说明</a>安装包管理器 Homebrew。</p>
<blockquote class="warning-note"><p>安装后，请务必按照终端中打印的说明将 Homebrew 添加到你的 <code>$PATH</code> 中。否则命令行将无法识别使用 <code>brew</code> 安装的包。</p></blockquote>
</li>
<li>
<p>使用 <code>brew install orbstack</code> 安装 <a href="https://orbstack.dev/" target="_blank" rel="noopener noreferrer">OrbStack</a> – 一个性能更好的 Docker Desktop 替代品。进入 OrbStack 设置，将内存使用限制设置为<strong>至少 4 GB</strong>（如果可以的话设置为 8 GB）+ CPU 使用限制设置为至少 4 核（即 400%）。如果你在 PostHog 工作，你可以使用 Brex 获取许可证。</p>
</li>
<li>
<p>继续<a href="#%E5%85%8B%E9%9A%86%E4%BB%93%E5%BA%93">克隆仓库</a>。</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ubuntu">Ubuntu<a href="#ubuntu" class="hash-link" aria-label="Ubuntu的直接链接" title="Ubuntu的直接链接">​</a></h4>
<ol>
<li>
<p>按照<a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noopener noreferrer">这里的官方说明</a>安装 Docker。</p>
</li>
<li>
<p>安装 <code>build-essential</code> 包：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> build-essential</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>继续<a href="#%E5%85%8B%E9%9A%86%E4%BB%93%E5%BA%93">克隆仓库</a>。</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="克隆仓库">克隆仓库<a href="#克隆仓库" class="hash-link" aria-label="克隆仓库的直接链接" title="克隆仓库的直接链接">​</a></h4>
<p>克隆 <a href="https://github.com/posthog/posthog" target="_blank" rel="noopener noreferrer">PostHog 仓库</a>。所有后续命令都假设你在 <code>posthog/</code> 文件夹中。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/PostHog/posthog </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token builtin class-name">cd</span><span class="token plain"> posthog/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="即时设置">即时设置<a href="#即时设置" class="hash-link" aria-label="即时设置的直接链接" title="即时设置的直接链接">​</a></h3>
<p>你可以使用 <a href="https://flox.dev/" target="_blank" rel="noopener noreferrer">Flox</a> 立即设置你的开发环境。Flox 是一个开发环境管理器，它负责管理开发 PostHog 所需的整个依赖关系图 – 所有这些都在仓库的 <code>.flox/manifest.toml</code> 中声明。要启动这个环境：</p>
<ol>
<li>
<p>安装 Flox（以及用于预提交检查的 <code>ruff</code> 和 <code>rustup</code>，这些在 Flox 环境之外）。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> flox ruff rustup </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> rustup-init </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> rustup default stable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>在仓库根目录下，激活环境。（首次激活时，系统会询问你是否希望使用 <code>direnv</code> 自动激活环境。）</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">flox activate</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>这会为你提供一个功能齐全的环境，其可执行文件和链接库存储在 <code>.flox/</code> 下。你现在应该能看到有关迁移和运行应用程序的说明。</p>
<p>就是这样！你现在可以按照你想要的方式修改 PostHog。查看<a href="/posthog-guide/handbook/engineering/project-structure">项目结构</a>了解仓库内容的介绍。要提交更改，请基于 <code>master</code> 创建一个新分支用于你的预期更改，然后开始开发。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="手动设置">手动设置<a href="#手动设置" class="hash-link" aria-label="手动设置的直接链接" title="手动设置的直接链接">​</a></h3>
<p>如果你不想使用<a href="#%E5%8D%B3%E6%97%B6%E8%AE%BE%E7%BD%AE">基于 Flox 的即时设置</a>，你也可以手动设置环境：</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-启动外部服务">1. 启动外部服务<a href="#1-启动外部服务" class="hash-link" aria-label="1. 启动外部服务的直接链接" title="1. 启动外部服务的直接链接">​</a></h4>
<p>在这一步中，我们将启动 PostHog 工作所需的所有外部服务。</p>
<p>首先，将 <code>127.0.0.1 kafka clickhouse</code> 行添加到 <code>/etc/hosts</code> 中。如果没有这些映射的主机，我们的 ClickHouse 和 Kafka 数据服务将无法相互通信。
你可以使用一行命令完成此操作：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;127.0.0.1 kafka clickhouse&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tee</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-a</span><span class="token plain"> /etc/hosts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>如果你使用的是较新版本（&gt;=4.1）的 Podman 而不是 Docker，主机的 <code>/etc/hosts</code> 默认用作容器的基础 hosts 文件，而不是像 Docker 中那样使用容器的 <code>/etc/hosts</code>。这可能会导致 ClickHouse 容器中的主机名解析失败，可以通过在 <a href="https://github.com/containers/common/blob/main/docs/containers.conf.5.md#containers-table" target="_blank" rel="noopener noreferrer"><code>containers.conf</code></a> 中设置 <code>base_hosts_file=&quot;none&quot;</code> 来解决。</p>
</blockquote>
<p>现在，启动 Docker Compose 堆栈：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> compose </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> docker-compose.dev.yml up</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>友情提示 1：</strong> 如果你看到 <code>Error while fetching server API version: 500 Server Error for http+docker://localhost/version:</code>，很可能是 Docker Engine 没有运行。</p>
</blockquote>
<blockquote>
<p><strong>友情提示 2：</strong> 如果你在任何地方看到&quot;Exit Code 137&quot;，这意味着容器内存不足。在这种情况下，你需要在 OrbStack 设置中分配更多的 RAM。</p>
</blockquote>
<blockquote>
<p><strong>友情提示 3：</strong> 在 Linux 上，你可能需要 <code>sudo</code> – 参见 <a href="https://docs.docker.com/engine/install/linux-postinstall" target="_blank" rel="noopener noreferrer">Docker 文档关于以非 root 用户管理 Docker</a>。或者考虑使用 <a href="https://podman.io/getting-started/installation" target="_blank" rel="noopener noreferrer">Podman</a> 作为支持无根容器的替代方案。</p>
</blockquote>
<blockquote>
<p><strong>友情提示 4：</strong> 如果你看到 <code>Error: (HTTP code 500) server error - Ports are not available: exposing port TCP 0.0.0.0:5432 -&gt; 0.0.0.0:0: listen tcp 0.0.0.0:5432: bind: address already in use</code>，说明某处已经运行了 Postgres。先尝试 <code>docker compose -f docker-compose.dev.yml</code>，或者运行 <code>lsof -i :5432</code> 查看哪个进程正在使用此端口。</p>
</blockquote>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> postgresql stop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>其次，通过 <code>docker ps</code> 和 <code>docker logs</code>（或通过 OrbStack 仪表板）验证所有这些服务是否正在运行。它们的日志应该显示类似这样的内容：</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># docker ps                                                                                     NAMES</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID   IMAGE                                      COMMAND                  CREATED          STATUS                    PORTS                                                                                            NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5a38d4e55447   temporalio/ui:2.10.3                       </span><span class="token string" style="color:#e3116c">&quot;./start-ui-server.sh&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">44</span><span class="token plain"> seconds             </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:8081-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">/tcp                                                                           posthog-temporal-ui-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">89b969801426   temporalio/admin-tools:1.20.0              </span><span class="token string" style="color:#e3116c">&quot;tail -f /dev/null&quot;</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">44</span><span class="token plain"> seconds                                                                                                              posthog-temporal-admin-tools-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">81fd1b6d7b1b   clickhouse/clickhouse-server:23.6.1.1524   </span><span class="token string" style="color:#e3116c">&quot;/entrypoint.sh&quot;</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> seconds             </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:8123-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">8123</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:9000-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">9000</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:9009-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">9009</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:9440-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">9440</span><span class="token plain">/tcp   posthog-clickhouse-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f876f8bff35f   bitnami/kafka:2.8.1-debian-10-r99          </span><span class="token string" style="color:#e3116c">&quot;/opt/bitnami/script…&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> seconds             </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:9092-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">9092</span><span class="token plain">/tcp                                                                           posthog-kafka-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d22559261575   temporalio/auto-setup:1.20.0               </span><span class="token string" style="color:#e3116c">&quot;/etc/temporal/entry…&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">45</span><span class="token plain"> seconds             </span><span class="token number" style="color:#36acaa">6933</span><span class="token plain">-6935/tcp, </span><span class="token number" style="color:#36acaa">6939</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">7234</span><span class="token plain">-7235/tcp, </span><span class="token number" style="color:#36acaa">7239</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:7233-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">7233</span><span class="token plain">/tcp                         posthog-temporal-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5313fc278a70   postgres:12-alpine                         </span><span class="token string" style="color:#e3116c">&quot;docker-entrypoint.s…&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> seconds </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">healthy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:5432-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">5432</span><span class="token plain">/tcp                                                                           posthog-db-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">c04358d8309f   zookeeper:3.7.0                            </span><span class="token string" style="color:#e3116c">&quot;/docker-entrypoint.…&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> seconds             </span><span class="token number" style="color:#36acaa">2181</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">2888</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">3888</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">/tcp                                                           posthog-zookeeper-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">09add699866e   maildev/maildev:2.0.5                      </span><span class="token string" style="color:#e3116c">&quot;bin/maildev&quot;</span><span class="token plain">            </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> seconds </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">healthy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:1025-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">1025</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:1080-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">1080</span><span class="token plain">/tcp                                                   posthog-maildev-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">61a44c094753   elasticsearch:7.16.2                       </span><span class="token string" style="color:#e3116c">&quot;/bin/tini -- /usr/l…&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> seconds             </span><span class="token number" style="color:#36acaa">9200</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">9300</span><span class="token plain">/tcp                                                                               posthog-elasticsearch-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a478cadf6911   minio/minio:RELEASE.2022-06-25T15-50-16Z   </span><span class="token string" style="color:#e3116c">&quot;sh -c &#x27;mkdir -p /da…&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> seconds             </span><span class="token number" style="color:#36acaa">9000</span><span class="token plain">/tcp, </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:19000-19001-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">19000</span><span class="token plain">-19001/tcp                                                   posthog-object_storage-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">91f838afe40e   redis:6.2.7-alpine                         </span><span class="token string" style="color:#e3116c">&quot;docker-entrypoint.s…&quot;</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">51</span><span class="token plain"> seconds ago   Up </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> seconds             </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0:6379-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">6379</span><span class="token plain">/tcp                                                                           posthog-redis-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># docker logs posthog-db-1 -n 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-12-06 </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:47:08.325 UTC </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> LOG:  database system is ready to accept connections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># docker logs posthog-redis-1 -n 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain">:M 06 Dec </span><span class="token number" style="color:#36acaa">2021</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:47:08.435 * Ready to accept connections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># docker logs posthog-clickhouse-1 -n 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Saved preprocessed configuration to </span><span class="token string" style="color:#e3116c">&#x27;/var/lib/clickhouse/preprocessed_configs/users.xml&#x27;</span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ClickHouse writes logs to `/var/log/clickhouse-server/clickhouse-server.log` and error logs to `/var/log/clickhouse-server/clickhouse-server.err.log` instead of stdout/stsderr. It can be useful to `cat` these files if there are any issues:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># docker exec posthog-clickhouse-1 cat /var/log/clickhouse-server/clickhouse-server.log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># docker exec posthog-clickhouse-1 cat /var/log/clickhouse-server/clickhouse-server.err.log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># docker logs posthog-kafka-1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2021</span><span class="token plain">-12-06 </span><span class="token number" style="color:#36acaa">13</span><span class="token plain">:47:23,814</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> INFO </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">KafkaServer </span><span class="token assign-left variable" style="color:#36acaa">id</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1001</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> started </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kafka.server.KafkaServer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># docker logs posthog-zookeeper-1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Because ClickHouse and Kafka connect to Zookeeper, there will be a lot of noise here. That&#x27;s good.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>友情提示：</strong> Kafka 目前是唯一使用的 x86 容器，在 ARM 上运行时可能会随机崩溃。重启它，当发生这种情况时。</p>
</blockquote>
<p>最后，在本地安装 Postgres。即使你计划在 Docker 中运行 Postgres，我们也需要本地安装 Postgres（11+ 版本）来获取其 CLI 工具和开发库/头文件。这些是 <code>pip</code> 安装 <code>psycopg2</code> 所必需的。</p>
<ul>
<li>在 macOS 上：<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> postgresql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>这会同时安装 Postgres 服务器和其工具。运行此命令后不要启动服务器。</p>
<ul>
<li>在基于 Debian 的 Linux 上：<!-- -->
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> postgresql-client postgresql-contrib libpq-dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<p>这有意只安装 Postgres 客户端和驱动程序，而不是服务器。如果你想安装服务器，或者已经安装了服务器，你需要停止它，因为它使用的 TCP 端口与 Postgres Docker 容器使用的端口冲突。在 Linux 上，可以使用 <code>sudo systemctl disable postgresql.service</code> 来完成此操作。</p>
<p>在 Linux 上，你通常有单独的包：<code>postgres</code> 用于工具，<code>postgres-server</code> 用于服务器，<code>libpostgres-dev</code> 用于 <code>psycopg2</code> 依赖项。查看你的发行版的包列表以获取最新的包列表。</p>
<p>如果你的工作站是 Apple Silicon Mac，第一次运行 <code>pip install</code> 时，你必须设置自定义 OpenSSL 头：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> openssl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">CFLAGS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-I /opt/homebrew/opt/openssl/include </span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable" style="color:#36acaa">python3.11-config </span><span class="token string variable parameter variable" style="color:#36acaa">--includes</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">LDFLAGS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-L /opt/homebrew/opt/openssl/lib&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">GRPC_PYTHON_BUILD_SYSTEM_OPENSSL</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">GRPC_PYTHON_BUILD_SYSTEM_ZLIB</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> uv pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> requirements.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这些将在安装 <code>grpcio</code> 和 <code>psycopg2</code> 时使用。完成此操作一次后，假设这两个包没有任何更改，下次只需运行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uv pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> requirements.txt </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> requirements-dev.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-准备-django-服务器">5. 准备 Django 服务器<a href="#5-准备-django-服务器" class="hash-link" aria-label="5. 准备 Django 服务器的直接链接" title="5. 准备 Django 服务器的直接链接">​</a></h4>
<ol>
<li>
<p>安装一些 SAML 工作所需的依赖项。如果你使用 macOS，运行下面的命令，否则查看官方 <a href="https://github.com/mehcode/python-xmlsec" target="_blank" rel="noopener noreferrer">xmlsec 仓库</a>了解更多详情。</p>
<ul>
<li>
<p>在 macOS 上：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> libxml2 libxmlsec1 pkg-config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>如果安装 <code>xmlsec</code> 不成功，尝试更新 macOS 到最新版本（Sonoma）。</p>
</blockquote>
</li>
<li>
<p>在基于 Debian 的 Linux 上：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"> libxml2 libxmlsec1-dev libffi-dev pkg-config</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>
<p>安装 Python 3.11。</p>
<ul>
<li>
<p>在 macOS 上，你可以使用 Homebrew：<code>brew install python@3.11</code>。</p>
</li>
<li>
<p>在基于 Debian 的 Linux 上：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> add-apt-repository ppa:deadsnakes/ppa </span><span class="token parameter variable" style="color:#36acaa">-y</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> python3.11 python3.11-venv python3.11-dev </span><span class="token parameter variable" style="color:#36acaa">-y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
</ol>
<p>确保在 <code>venv</code> 外部时始终使用 <code>python3</code> 而不是 <code>python</code>，因为后者在某些系统上可能指向 Python 2.x。如果安装多个版本的 Python 3，例如使用 <code>deadsnakes</code> PPA，使用 <code>python3.11</code> 而不是 <code>python3</code>。</p>
<p>你也可以使用 <a href="https://github.com/pyenv/pyenv" target="_blank" rel="noopener noreferrer">pyenv</a>，如果你希望在同一台机器上管理多个 Python 3 版本。</p>
<ol start="3">
<li>安装 <code>uv</code></li>
</ol>
<p><code>uv</code> 是一个非常快速的工具，你可以用它来管理 python 虚拟环境和依赖项。查看 <a href="https://docs.astral.sh/uv/" target="_blank" rel="noopener noreferrer">https://docs.astral.sh/uv/</a>。安装后，你可以在任何 <code>pip</code> 命令前加上 <code>uv</code> 来获得速度提升。</p>
<ol start="4">
<li>
<p>在当前目录下创建名为 &#x27;env&#x27; 的虚拟环境：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uv venv </span><span class="token function" style="color:#d73a49">env</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--python</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3.11</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>激活虚拟环境：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 对于 bash/zsh/等</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">source</span><span class="token plain"> env/bin/activate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 对于 fish</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">source</span><span class="token plain"> env/bin/activate.fish</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>将 pip 升级到最新版本：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uv pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-U</span><span class="token plain"> pip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>使用 pip 安装依赖项</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="6-准备数据库">6. 准备数据库<a href="#6-准备数据库" class="hash-link" aria-label="6. 准备数据库的直接链接" title="6. 准备数据库的直接链接">​</a></h4>
<p>我们现在已经准备好了后端，并且 Postgres 和 ClickHouse 正在运行 – 但是这些数据库目前是空白的，所以我们需要运行_迁移_来创建所有表等：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cargo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> sqlx-cli </span><span class="token comment" style="color:#999988;font-style:italic"># 如果你还没有安装</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">DEBUG</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> ./bin/migrate</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="7-启动-posthog">7. 启动 PostHog<a href="#7-启动-posthog" class="hash-link" aria-label="7. 启动 PostHog的直接链接" title="7. 启动 PostHog的直接链接">​</a></h4>
<p>现在同时启动 PostHog 的所有组件（后端、worker、插件服务器和前端）：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./bin/start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>注意：</strong> 此命令使用 <a href="https://github.com/pvolok/mprocs" target="_blank" rel="noopener noreferrer">mprocs</a> 在单个终端窗口中运行所有开发进程。</p>
</blockquote>
<p>打开 <a href="http://localhost:8010" target="_blank" rel="noopener noreferrer">http://localhost:8010</a> 查看应用程序。</p>
<blockquote>
<p><strong>注意：</strong> 第一次运行此命令时，你可能会收到一个错误，说&quot;layout.html is not defined&quot;。请确保等待前端编译完成后再试一次。</p>
</blockquote>
<p>要在你全新的 PostHog 实例中获取一些实用的测试数据，运行 <code>DEBUG=1 ./manage.py generate_demo_data</code>。要查看命令的有用参数列表，运行 <code>DEBUG=1 ./manage.py generate_demo_data --help</code>。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="8-开发">8. 开发<a href="#8-开发" class="hash-link" aria-label="8. 开发的直接链接" title="8. 开发的直接链接">​</a></h4>
<p>就是这样！你现在可以按照你想要的方式修改 PostHog。查看<a href="/posthog-guide/handbook/engineering/project-structure">项目结构</a>了解仓库内容的介绍。要提交更改，请基于 <code>master</code> 创建一个新分支用于你的预期更改，然后开始开发。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="测试">测试<a href="#测试" class="hash-link" aria-label="测试的直接链接" title="测试的直接链接">​</a></h2>
<p>要合并 PostHog PR，所有测试都必须通过，理想情况下你还应该引入新的测试 - 这就是为什么你必须能够轻松运行测试。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="前端">前端<a href="#前端" class="hash-link" aria-label="前端的直接链接" title="前端的直接链接">​</a></h3>
<p>对于前端单元测试，运行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> test:unit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你可以将运行范围缩小到仅匹配路径下的文件：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> jest </span><span class="token parameter variable" style="color:#36acaa">--testPathPattern</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">frontend/src/lib/components/IntervalFilter/intervalFilterLogic.test.ts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>要更新所有视觉回归测试快照，请确保 Storybook 在你的机器上运行（你可以在单独的终端标签中使用 <code>pnpm storybook</code> 启动它）。你可能还需要使用 <code>pnpm exec playwright install</code> 安装 Playwright。然后运行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> test:visual</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>要仅更新特定路径下的故事的快照，运行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">pnpm</span><span class="token plain"> test:visual:update frontend/src/lib/Example.stories.tsx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="后端">后端<a href="#后端" class="hash-link" aria-label="后端的直接链接" title="后端的直接链接">​</a></h3>
<p>对于后端测试，运行：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pytest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>你可以将运行范围缩小到仅匹配路径下的文件：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pytest posthog/test/test_example.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>或者仅测试匹配函数名的测试用例：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pytest posthog/test/test_example.py </span><span class="token parameter variable" style="color:#36acaa">-k</span><span class="token plain"> test_something</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>要查看调试日志（如 ClickHouse 查询），添加参数 <code>--log-cli-level=DEBUG</code>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="端到端">端到端<a href="#端到端" class="hash-link" aria-label="端到端的直接链接" title="端到端的直接链接">​</a></h3>
<p>对于 Cypress 端到端测试，运行 <code>bin/e2e-test-runner</code>。这将启动一个 PostHog 的测试实例并显示 Cypress 界面，你可以从中手动选择要运行的测试。你需要安装 <code>uv</code>（Python 包管理器），你可以通过 <code>brew install uv</code> 来安装。完成后，使用 Cmd + C 终止命令。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="额外使用特性标志">额外：使用特性标志<a href="#额外使用特性标志" class="hash-link" aria-label="额外：使用特性标志的直接链接" title="额外：使用特性标志的直接链接">​</a></h2>
<p>当使用环境变量 <code>DEBUG=1</code>（启用名为 <code>SELF_CAPTURE</code> 的设置）在本地开发时，
你的本地 PostHog 实例中的所有分析都基于该实例本身 - 更具体地说，是基于当前选择的项目。
这意味着你的活动会立即反映在当前项目中，这对于测试功能可能很有用</p>
<ul>
<li>例如，当前开发实例启用哪些特性标志是由你同时打开的项目决定的。</li>
</ul>
<p>因此，当使用基于特性标志 <code>foo-bar</code> 的功能时，<a href="http://localhost:8010/feature_flags/new" target="_blank" rel="noopener noreferrer">在你的本地实例中添加具有此键的特性标志</a>并在那里发布它。</p>
<p>如果你想立即拥有 PostHog 中存在的所有特性标志，运行 <code>DEBUG=1 python3 manage.py sync_feature_flags</code> - 它们将被添加到实例中的每个项目中，默认情况下完全展开。</p>
<p>此命令会自动将任何以 <code>_EXPERIMENT</code> 结尾的特性标志设置为具有 <code>control</code> 和 <code>test</code> 变体的多变量标志。</p>
<p>后端侧的标志仅在本地评估，这需要设置 <code>POSTHOG_PERSONAL_API_KEY</code> 环境变量。在<a href="http://localhost:8010/settings/user#personal-api-keys" target="_blank" rel="noopener noreferrer">你的用户设置</a>中生成密钥。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="额外使用-vs-code-调试">额外：使用 VS Code 调试<a href="#额外使用-vs-code-调试" class="hash-link" aria-label="额外：使用 VS Code 调试的直接链接" title="额外：使用 VS Code 调试的直接链接">​</a></h2>
<p>PostHog 仓库包含了 <a href="https://github.com/PostHog/posthog/blob/master/.vscode/launch.json" target="_blank" rel="noopener noreferrer">VS Code 调试选项</a>。只需转到 VS Code 中的 <code>运行和调试</code> 标签，选择你想要调试的所需服务，然后运行它。一旦它启动，你就可以设置断点并逐步执行代码，以准确了解发生了什么。如果你遇到棘手的测试失败，还有用于前端和后端测试的调试启动选项。</p>
<blockquote>
<p><strong>注意：</strong> 你可以使用主要的&quot;PostHog&quot;启动选项调试所有服务。否则，如果你使用 <code>./bin/start</code> 在本地运行大多数 PostHog 服务，例如，如果你只想调试后端，请确保暂时从<a href="https://github.com/PostHog/posthog/blob/master/bin/start#L22" target="_blank" rel="noopener noreferrer">启动脚本</a>中注释掉该服务。</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="extra-debugging-the-backend-in-pycharm">Extra: Debugging the backend in PyCharm<a href="#extra-debugging-the-backend-in-pycharm" class="hash-link" aria-label="Extra: Debugging the backend in PyCharm的直接链接" title="Extra: Debugging the backend in PyCharm的直接链接">​</a></h2>
<p>借助 PyCharm 内置的 Django 支持，在后端设置调试相当容易。当你想要跟踪和调试从客户端发出的网络请求一直到服务器时，这特别有用。你可以设置断点并逐步执行代码，以准确了解后端如何处理你的请求。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="设置-pycharm">设置 PyCharm<a href="#设置-pycharm" class="hash-link" aria-label="设置 PyCharm的直接链接" title="设置 PyCharm的直接链接">​</a></h3>
<ol>
<li>打开仓库文件夹。</li>
<li>设置 python 解释器（设置... &gt; 项目：posthog &gt; Python 解释器 &gt; 添加解释器）：选择&quot;现有&quot;并将其设置为 <code>path_to_repo/posthog/env/bin/python</code>。</li>
<li>设置 Django 支持（设置... &gt; 语言和框架 &gt; Django）：<!-- -->
<ul>
<li>Django 项目根目录：<code>path_to_repo</code></li>
<li>设置：<code>posthog/settings/__init__py</code></li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="启动调试环境">启动调试环境<a href="#启动调试环境" class="hash-link" aria-label="启动调试环境的直接链接" title="启动调试环境的直接链接">​</a></h3>
<ol>
<li>不要手动运行 <code>docker compose</code>，你可以打开 <code>docker-compose.dev.yml</code> 文件并点击 <code>services</code> 旁边的双播放图标</li>
<li>从运行配置中选择：<!-- -->
<ul>
<li>&quot;PostHog&quot; 并点击调试</li>
<li>&quot;Celery&quot; 并点击调试（可选）</li>
<li>&quot;Frontend&quot; 并点击运行</li>
<li>&quot;Plugin server&quot; 并点击运行</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="extra-accessing-postgres">Extra: Accessing Postgres<a href="#extra-accessing-postgres" class="hash-link" aria-label="Extra: Accessing Postgres的直接链接" title="Extra: Accessing Postgres的直接链接">​</a></h2>
<p>在开发过程中，你可能需要连接到数据库来查询本地数据库、进行更改等。要连接到数据库，请使用像 pgAdmin 这样的工具并输入以下连接详细信息：<em>host</em>:<code>localhost</code> <em>port</em>:<code>5432</code> <em>database</em>:<code>posthog</code>, <em>username</em>:<code>posthog</code>, <em>pwd</em>:<code>posthog</code>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="extra-accessing-the-django-admin">Extra: Accessing the Django Admin<a href="#extra-accessing-the-django-admin" class="hash-link" aria-label="Extra: Accessing the Django Admin的直接链接" title="Extra: Accessing the Django Admin的直接链接">​</a></h2>
<p>如果你无法访问 Django admin <a href="http://localhost:8000/admin/%EF%BC%8C%E5%8F%AF%E8%83%BD%E6%98%AF%E5%9B%A0%E4%B8%BA%E4%BD%A0%E7%9A%84%E6%9C%AC%E5%9C%B0%E7%94%A8%E6%88%B7%E6%9C%AA%E8%AE%BE%E7%BD%AE%E4%B8%BA%E5%B7%A5%E4%BD%9C%E4%BA%BA%E5%91%98%E7%94%A8%E6%88%B7%E3%80%82%E4%BD%A0%E5%8F%AF%E4%BB%A5%E8%BF%9E%E6%8E%A5%E5%88%B0%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%8C%E6%89%BE%E5%88%B0%E4%BD%A0%E7%9A%84" target="_blank" rel="noopener noreferrer">http://localhost:8000/admin/，可能是因为你的本地用户未设置为工作人员用户。你可以连接到数据库，找到你的</a> <code>posthog_user</code> 并将 <code>is_staff</code> 设置为 <code>true</code>。这应该使管理页面可以访问。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="额外开发付费功能仅限-posthog-员工">额外：开发付费功能（仅限 PostHog 员工）<a href="#额外开发付费功能仅限-posthog-员工" class="hash-link" aria-label="额外：开发付费功能（仅限 PostHog 员工）的直接链接" title="额外：开发付费功能（仅限 PostHog 员工）的直接链接">​</a></h2>
<p>如果你是 PostHog 员工，你可以在本地实例上访问付费功能，以使开发更容易。<a href="https://github.com/PostHog/billing?tab=readme-ov-file#licensing-your-local-instance" target="_blank" rel="noopener noreferrer">在我们的内部指南中了解如何操作</a>。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="extra-working-with-the-data-warehouse-and-a-mysql-source">Extra: Working with the data warehouse and a MySQL source<a href="#extra-working-with-the-data-warehouse-and-a-mysql-source" class="hash-link" aria-label="Extra: Working with the data warehouse and a MySQL source的直接链接" title="Extra: Working with the data warehouse and a MySQL source的直接链接">​</a></h2>
<p>如果你想将本地 MySQL 数据库设置为数据仓库的源，你需要完成一些额外的设置步骤：</p>
<ol>
<li>设置要连接的本地 MySQL 数据库。</li>
<li>在你的机器上安装 MS SQL 驱动程序。</li>
<li>为 Temporal 任务运行器定义额外的环境变量。</li>
</ol>
<p>首先，安装 MySQL：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">brew services start mysql</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>安装 MySQL 后，创建数据库和表，插入一行数据，并创建一个可以连接的用户：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> root</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATABASE</span><span class="token plain"> posthog_dw_test</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">IF</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">EXISTS</span><span class="token plain"> payments </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id </span><span class="token keyword" style="color:#00009f">INT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AUTO_INCREMENT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIMARY</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">KEY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">timestamp</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATETIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> distinct_id </span><span class="token keyword" style="color:#00009f">VARCHAR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> amount </span><span class="token keyword" style="color:#00009f">DECIMAL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> payments </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">timestamp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> distinct_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> amount</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">NOW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;testuser@example.com&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99.99</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">USER</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;posthog&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;%&#x27;</span><span class="token plain"> IDENTIFIED </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;posthog&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GRANT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ALL</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> posthog_dw_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TO</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;posthog&#x27;</span><span class="token variable" style="color:#36acaa">@&#x27;%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FLUSH </span><span class="token keyword" style="color:#00009f">PRIVILEGES</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接下来，你需要安装一些 MS SQL 驱动程序，以便 PostHog 应用程序连接到 MySQL 数据库。在 <a href="https://github.com/PostHog/posthog/blob/master/posthog/warehouse/README.md" target="_blank" rel="noopener noreferrer">posthog/warehouse/README.md</a> 中了解完整过程。如果没有驱动程序，在将 SQL 数据库连接到数据仓库时，你会收到以下错误：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">symbol not found in flat namespace &#x27;_bcp_batch&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>最后，你需要定义这些环境变量，以便 Temporal 任务运行器监视正确的队列并按预期工作：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 在 #team-data-warehouse 中询问这些值</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PYTHONUNBUFFERED=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export DJANGO_SETTINGS_MODULE=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export DEBUG=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export CLICKHOUSE_SECURE=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export KAFKA_HOSTS=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export DATABASE_URL=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export SKIP_SERVICE_VERSION_REQUIREMENTS=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PRINT_SQL=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export BUCKET_URL=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export AIRBYTE_BUCKET_KEY=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export AIRBYTE_BUCKET_SECRET=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export AIRBYTE_BUCKET_REGION=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export AIRBYTE_BUCKET_DOMAIN=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export TEMPORAL_TASK_QUEUE=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export AWS_S3_ALLOW_UNSAFE_RENAME=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export HUBSPOT_APP_CLIENT_ID=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export HUBSPOT_APP_CLIENT_SECRET=</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如果你将它们放在 <code>.temporal-worker-settings</code> 文件中，你可以在调用 <code>DEBUG=1 ./bin/start</code> 之前运行 <code>source .temporal-worker-settings</code>。</p>
<p>要验证一切是否按预期工作：</p>
<ol>
<li>在 PostHog 应用程序中导航到&quot;数据管道&quot;。</li>
<li>使用上述设置创建新的 MySQL 源。</li>
<li>创建源后，点击&quot;MySQL&quot;项。在架构表中，点击三点菜单并选择&quot;重新加载&quot;选项。</li>
</ol>
<p>作业运行后，点击同步的表名应该会带你到你的数据。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/pama-lee/posthog-guide/tree/main/docs/🚀 部署/developing-locally.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer><div style="margin-top:2rem"></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/posthog-guide/docs/🚀 部署/cloud-cluster"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Cloud 集群架构</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/posthog-guide/docs/🚀 部署/nomad"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">使用 Nomad 部署 PostHog</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#posthog-内部结构是什么样的" class="table-of-contents__link toc-highlight">PostHog 内部结构是什么样的？</a></li><li><a href="#选项一使用-codespaces-开发" class="table-of-contents__link toc-highlight">选项一：使用 Codespaces 开发</a></li><li><a href="#选项二本地开发" class="table-of-contents__link toc-highlight">选项二：本地开发</a><ul><li><a href="#先决条件" class="table-of-contents__link toc-highlight">先决条件</a></li><li><a href="#即时设置" class="table-of-contents__link toc-highlight">即时设置</a></li><li><a href="#手动设置" class="table-of-contents__link toc-highlight">手动设置</a></li></ul></li><li><a href="#测试" class="table-of-contents__link toc-highlight">测试</a><ul><li><a href="#前端" class="table-of-contents__link toc-highlight">前端</a></li><li><a href="#后端" class="table-of-contents__link toc-highlight">后端</a></li><li><a href="#端到端" class="table-of-contents__link toc-highlight">端到端</a></li></ul></li><li><a href="#额外使用特性标志" class="table-of-contents__link toc-highlight">额外：使用特性标志</a></li><li><a href="#额外使用-vs-code-调试" class="table-of-contents__link toc-highlight">额外：使用 VS Code 调试</a></li><li><a href="#extra-debugging-the-backend-in-pycharm" class="table-of-contents__link toc-highlight">Extra: Debugging the backend in PyCharm</a><ul><li><a href="#设置-pycharm" class="table-of-contents__link toc-highlight">设置 PyCharm</a></li><li><a href="#启动调试环境" class="table-of-contents__link toc-highlight">启动调试环境</a></li></ul></li><li><a href="#extra-accessing-postgres" class="table-of-contents__link toc-highlight">Extra: Accessing Postgres</a></li><li><a href="#extra-accessing-the-django-admin" class="table-of-contents__link toc-highlight">Extra: Accessing the Django Admin</a></li><li><a href="#额外开发付费功能仅限-posthog-员工" class="table-of-contents__link toc-highlight">额外：开发付费功能（仅限 PostHog 员工）</a></li><li><a href="#extra-working-with-the-data-warehouse-and-a-mysql-source" class="table-of-contents__link toc-highlight">Extra: Working with the data warehouse and a MySQL source</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/posthog-guide/docs/intro">入门指南</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://posthog.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">PostHog 官网<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/PostHog/posthog" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/posthog-guide/blog">博客</a></li><li class="footer__item"><a href="https://github.com/pama-lee/posthog-guide" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 PostHog 指南.</div></div></div></footer></div>
</body>
</html>